}function o(e, t, i) { e.updateComponent(t, i) } function a(e, t, i) { c.prototype.setAttribute.call(e, t, i), "mixin" === t && e.mixinUpdate(i) } var s, l; return s = e.split(g)[0], u[s] ? ("string" == typeof t && "undefined" != typeof i ? n(this, e, t, i) : "object" == typeof t && i === !0 ? o(this, e, t) : r(this, e, t), l = this.sceneEl && this.sceneEl.getAttribute("debug"), void (l && this.components[e].flushToDOM())) : void a(this, e, t)}, writable: window.debug}, flushToDOM: { value: function(e) { var t, i, n = this.components, r = this.defaultComponents, o = this.children; if (Object.keys(n).forEach(function (e) { n[e].flushToDOM(e in r) }), e) for (i = 0; i < o.length; ++i)t = o[i], t.flushToDOM && t.flushToDOM(e) } }, getAttribute: { value: function(e) { var t = this.components[e]; return t ? t.getData() : HTMLElement.prototype.getAttribute.call(this, e) }, writable: window.debug }, getComputedAttribute: { value: function(e) { return m("`getComputedAttribute` is deprecated. Use `getAttribute` instead."), this.getAttribute(e) } }, getDOMAttribute: { value: function(e) { var t = this.components[e]; return t ? t.attrValue : HTMLElement.prototype.getAttribute.call(this, e) }, writable: window.debug }, addState: { value: function(e) { this.is(e) || (this.states.push(e), this.mapStateMixins(e, p(this.registerMixin, this)), this.emit("stateadded", { state: e })) } }, removeState: { value: function(e) { var t = this.states.indexOf(e); t !== -1 && (this.states.splice(t, 1), this.mapStateMixins(e, p(this.unregisterMixin, this)), this.emit("stateremoved", { state: e })) } }, is: { value: function(e) { return this.states.indexOf(e) !== -1 } }}); s = l("a-entity", { prototype: v }), t.exports = s}, { "../lib/three": 146, "../utils/": 167, "./a-node": 98, "./a-register-element": 99, "./component": 100 }], 97: [function (e, t, i) { var n = e("./a-node"), r = e("./a-register-element").registerElement, o = e("./component").components, a = "__"; t.exports = r("a-mixin", { prototype: Object.create(n.prototype, { createdCallback: { value: function () { this.componentCache = {}, this.id = this.getAttribute("id") } }, attributeChangedCallback: { value: function (e, t, i) { this.cacheAttribute(e, i) } }, attachedCallback: { value: function () { this.sceneEl = this.closestScene(), this.cacheAttributes(), this.updateEntities(), this.load() } }, setAttribute: { value: function (e, t) { this.cacheAttribute(e, t), HTMLElement.prototype.setAttribute.call(this, e, t) } }, cacheAttribute: { value: function (e, t) { var i = e.split(a)[0], n = o[i]; n && (void 0 === t && (t = HTMLElement.prototype.getAttribute.call(this, e)), this.componentCache[e] = n.parseAttrValueForCache(t)) } }, getAttribute: { value: function (e) { return this.componentCache[e] || HTMLElement.prototype.getAttribute.call(this, e) } }, cacheAttributes: { value: function () { var e, t, i = this.attributes; for (t = 0; t < i.length; t++)e = i[t].name, this.cacheAttribute(e) } }, updateEntities: { value: function () { if (this.sceneEl) for (var e = this.sceneEl.querySelectorAll("[mixin~=" + this.id + "]"), t = 0; t < e.length; t++) { var i = e[t]; i.hasLoaded && (i.registerMixin(this.id), Object.keys(this.componentCache).forEach(function (e) { i.updateComponent(e) })) } } } }) }) }, { "./a-node": 98, "./a-register-element": 99, "./component": 100 }], 98: [function (e, t, i) { var n = e("./a-register-element").registerElement, r = e("../utils/"), o = r.bind, a = r.debug("core:a-node:warn"); t.exports = n("a-node", { prototype: Object.create(HTMLElement.prototype, { createdCallback: { value: function () { this.hasLoaded = !1, this.isNode = !0, this.mixinEls = [], this.mixinObservers = {} }, writable: window.debug }, attachedCallback: { value: function () { var e; this.sceneEl = this.closestScene(), this.sceneEl || a("You are attempting to attach <" + this.tagName + "> outside of an A-Frame scene. Append this element to `<a-scene>` instead."), this.hasLoaded = !1, this.emit("nodeready", {}, !1), e = this.getAttribute("mixin"), e && this.updateMixins(e) }, writable: window.debug }, attributeChangedCallback: { value: function (e, t, i) { "mixin" === e && this.updateMixins(i, t) } }, closestScene: { value: function () { for (var e = this; e && !e.isScene;)e = e.parentElement; return e } }, closest: { value: function (e) { for (var t = this.matches || this.mozMatchesSelector || this.msMatchesSelector || this.oMatchesSelector || this.webkitMatchesSelector, i = this; i && !t.call(i, e);)i = i.parentElement; return i } }, detachedCallback: { value: function () { this.hasLoaded = !1 } }, load: { value: function (e, t) { var i, n, r = this; this.hasLoaded || (t = t || function (e) { return e.isNode }, i = this.getChildren(), n = i.filter(t).map(function (e) { return new Promise(function (t) { return e.hasLoaded ? t() : void e.addEventListener("loaded", t) }) }), Promise.all(n).then(function () { r.hasLoaded = !0, e && e(), r.emit("loaded", {}, !1) })) }, writable: !0 }, getChildren: { value: function () { return Array.prototype.slice.call(this.children, 0) } }, updateMixins: { value: function (e, t) { var i = e ? e.trim().split(/\s+/) : [], n = t ? t.trim().split(/\s+/) : [], r = n.filter(function (e) { return i.indexOf(e) < 0 }); this.mixinEls = [], r.forEach(o(this.unregisterMixin, this)), i.forEach(o(this.registerMixin, this)) } }, registerMixin: { value: function (e) { if (this.sceneEl) { var t = this.sceneEl.querySelector("a-mixin#" + e); t && (this.attachMixinListener(t), this.mixinEls.push(t)) } } }, setAttribute: { value: function (e, t) { "mixin" === e && this.updateMixins(t), HTMLElement.prototype.setAttribute.call(this, e, t) } }, unregisterMixin: { value: function (e) { var t, i, n = this.mixinEls; for (i = 0; i < n.length; ++i)if (t = n[i], e === t.id) { n.splice(i, 1); break } this.removeMixinListener(e) } }, removeMixinListener: { value: function (e) { var t = this.mixinObservers[e]; t && (t.disconnect(), this.mixinObservers[e] = null) } }, attachMixinListener: { value: function (e) { var t = this, i = e.id, n = this.mixinObservers[i]; if (e && !n) { var r = new MutationObserver(function (e) { var i = e[0].attributeName; t.handleMixinUpdate(i) }), o = { attributes: !0 }; r.observe(e, o), this.mixinObservers[i] = r } } }, handleMixinUpdate: { value: function () { } }, emit: { value: function (e, t, i) { var n = this; t = t || {}, void 0 === i && (i = !0); var o = { bubbles: !!i, detail: t }; return e.split(" ").map(function (e) { return r.fireEvent(n, e, o) }) } }, emitter: { value: function (e, t, i) { var n = this; return function () { n.emit(e, t, i) } } } }) }) }, { "../utils/": 167, "./a-register-element": 99 }], 99: [function (e, t, i) { function n(e) { h[e.toLowerCase()] = !0 } function r(e) { var t = {}, i = ["attachedCallback", "attributeChangedCallback", "createdCallback"]; return a(t, i, e, u.prototype), c(e, t), t } function o(e) { var t = {}, i = ["attachedCallback", "attributeChangedCallback", "createdCallback"], n = ["attachedCallback", "attributeChangedCallback", "createdCallback", "detachedCallback"]; return a(t, i, e, u.prototype), a(t, n, e, l.prototype), c(e, t), t } function a(e, t, i, n) { t.forEach(function (t) { s(e, t, i, n) }) } function s(e, t, i, n) { var r = i[t], o = n[t]; r && o && r !== o && (e[t] = { value: function () { return o.apply(this, arguments), r.apply(this, arguments) }, writable: window.debug }) } function c(e, t) { var i = Object.getOwnPropertyNames(e); i.forEach(function (i) { var n; t[i] || (n = Object.getOwnPropertyDescriptor(e, i), t[i] = { value: e[i], writable: n.writable }) }) } e("document-register-element"); var u, l, h = t.exports.knownTags = {}; t.exports.isNode = function (e) { return e.tagName.toLowerCase() in h || e.isNode }, t.exports.registerElement = function (e, t) { var i = Object.getPrototypeOf(t.prototype), a = t, s = u && i === u.prototype, c = l && i === l.prototype; return (s || c) && n(e), s && (a = r(t.prototype), a = { prototype: Object.create(i, a) }), c && (a = o(t.prototype), a = { prototype: Object.create(i, a) }), document.registerElement(e, a) }, t.exports.wrapMethods = a, u = e("./a-node"), l = e("./a-entity") }, { "./a-entity": 96, "./a-node": 98, "document-register-element": 16 }], 100: [function (e, t, i) { function n(e, t, i, n, o, a) { function s(e) { var t = e.getAttribute(i); t && (c = r(c, t, h)) } var c, u = void 0 !== o && null !== o, h = m(n), f = e.mixinEls; return h ? c = n.default : (c = {}, Object.keys(n).forEach(function (e) { var t = n[e].default; c[e] = t && t.constructor === Object ? l.extend({}, t) : t })), f.forEach(s), u ? h ? p(o, n) : (c = r(c, o, h), d(c, n, void 0, t, a)) : h ? p(c, n) : d(c, n, void 0, t, a) } function r(e, t, i) { return i ? t : l.extend(e, t) } function o(e) { return function () { var t = this.el.sceneEl; this.isPlaying && (e.call(this), this.isPlaying = !1, this.tick && t.removeBehavior(this)) } } function a(e) { return function () { var t = this.el.sceneEl, i = this.el.isPlaying && !this.isPlaying; this.initialized && i && (e.call(this), this.isPlaying = !0, this.tick && t.addBehavior(this)) } } var s = e("./schema"), c = e("./scene/scenes"), u = e("./system"), l = e("../utils/"), h = t.exports.components = {}, d = s.parseProperties, p = s.parseProperty, f = s.process, m = s.isSingleProperty, g = s.stringifyProperties, v = s.stringifyProperty, y = l.styleParser, M = l.debug("core:component:warn"), A = document.currentScript, w = new RegExp("[A-Z]+"), x = t.exports.Component = function (e, t, i) { this.el = e, this.id = i, this.attrName = this.name + (i ? "__" + i : ""), this.updateProperties(t) }; if (x.prototype = { schema: {}, init: function () { }, update: function (e) { }, updateSchema: void 0, tick: void 0, play: function () { }, pause: function () { }, remove: function () { }, parse: function (e, t) { var i = this.schema; return m(i) ? p(e, i) : d(y.parse(e), i, !0, this.name, t) }, stringify: function (e) { var t = this.schema; return "string" == typeof e ? e : m(t) ? v(e, t) : (e = g(e, t), y.stringify(e)) }, getData: function () { var e = this.data; return "object" != typeof e ? e : l.extend({}, e) }, updateCachedAttrValue: function (e) { var t = m(this.schema), i = this.parseAttrValueForCache(e); this.attrValue = r({}, i, t) }, parseAttrValueForCache: function (e) { var t; return "string" != typeof e ? e : (m(this.schema) ? (t = this.schema.parse(e), "string" == typeof t && (t = e)) : t = y.parse(e), t) }, flushToDOM: function (e) { var t = e ? this.data : this.attrValue; t && HTMLElement.prototype.setAttribute.call(this.el, this.attrName, this.stringify(t)) }, updateProperties: function (e) { var t = this.el, i = m(this.schema), o = r({}, this.data, i); if (void 0 !== e && this.updateCachedAttrValue(e), t.hasLoaded) if (this.updateSchema && this.updateSchema(n(t, this.name, this.attrName, this.schema, this.attrValue, !0)), this.data = n(t, this.name, this.attrName, this.schema, this.attrValue), this.initialized) { if (l.deepEqual(o, this.data)) return; this.update(o), t.emit("componentchanged", { id: this.id, name: this.name, newData: this.getData(), oldData: o }, !1) } else this.init(), this.initialized = !0, this.update(o), t.isPlaying && this.play(), t.emit("componentinitialized", { id: this.id, name: this.name, data: this.getData() }, !1) }, resetProperty: function (e) { if (m(this.schema)) this.attrValue = void 0; else { if (!(e in this.attrValue)) return; delete this.attrValue[e] } this.updateProperties(this.attrValue) }, extendSchema: function (e) { var t = l.extend({}, h[this.name].schema); l.extend(t, e), this.schema = f(t), this.el.emit("schemachanged", { component: this.name }) } }, window.debug) var E = t.exports.registrationOrderWarnings = {}; t.exports.registerComponent = function (e, t) { var i, n = {}; if (document.currentScript && document.currentScript !== A && c.forEach(function (t) { t.hasLoaded || document.currentScript.compareDocumentPosition(t) !== Node.DOCUMENT_POSITION_FOLLOWING && (M("The component `" + e + "` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."), window.debug && (E[e] = !0)) }), w.test(e) === !0 && M("The component name `" + e + "` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `" + e.toLowerCase() + "`"), e.indexOf("__") !== -1) throw new Error("The component name `" + e + "` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type"); if (Object.keys(t).forEach(function (e) { n[e] = { value: t[e], writable: !0 } }), h[e]) throw new Error("The component `" + e + "` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name."); return i = function (e, t, i) { x.call(this, e, t, i) }, i.prototype = Object.create(x.prototype, n), i.prototype.name = e, i.prototype.constructor = i, i.prototype.system = u && u.systems[e], i.prototype.play = a(i.prototype.play), i.prototype.pause = o(i.prototype.pause), h[e] = { Component: i, dependencies: i.prototype.dependencies, isSingleProp: m(i.prototype.schema), multiple: i.prototype.multiple, parse: i.prototype.parse, parseAttrValueForCache: i.prototype.parseAttrValueForCache, schema: l.extend(f(i.prototype.schema)), stringify: i.prototype.stringify, type: i.prototype.type }, i }, t.exports.buildData = n }, { "../utils/": 167, "./scene/scenes": 106, "./schema": 108, "./system": 110 }], 101: [function (e, t, i) { var n = e("./schema"), r = n.process, o = t.exports.geometries = {}, a = t.exports.geometryNames = [], s = e("../lib/three"), c = t.exports.Geometry = function () { }; c.prototype = { schema: {}, init: function (e) { return this.geometry = new s.Geometry, this.geometry }, update: function (e) { } }, t.exports.registerGeometry = function (e, t) { var i, n = {}; if (Object.keys(t).forEach(function (e) { n[e] = { value: t[e], writable: !0 } }), o[e]) throw new Error("The geometry `" + e + "` has been already registered"); return i = function () { c.call(this) }, i.prototype = Object.create(c.prototype, n), i.prototype.name = e, i.prototype.constructor = i, o[e] = { Geometry: i, schema: r(i.prototype.schema) }, a.push(e), i } }, { "../lib/three": 146, "./schema": 108 }], 102: [function (e, t, i) { function n(e, t, i, n) { return "type" in x ? void A("Property type " + e + " is already registered.") : void (x[e] = { default: t, parse: i || s, stringify: n || c }) } function r(e) { function t(e) { return e.trim() } return Array.isArray(e) ? e : e && "string" == typeof e ? e.split(",").map(t) : [] } function o(e) { return e.join(", ") } function a(e) { var t, i; return "string" != typeof e ? e : (i = e.match(/\url\((.+)\)/), i ? i[1] : "#" === e.charAt(0) ? (t = d(e)) ? "CANVAS" === t.tagName || "VIDEO" === t.tagName ? t : t.getAttribute("src") : void w('"' + e + '" asset not found.') : e) } function s(e) { return e } function c(e) { return null === e ? "null" : e.toString() } function u(e) { return "false" !== e && e !== !1 } function l(e) { return parseInt(e, 10) } function h(e) { return parseFloat(e, 10) } function d(e) { return e ? "string" != typeof e ? e : document.querySelector(e) : null } function p(e) { return e ? "string" != typeof e ? e : Array.prototype.slice.call(document.querySelectorAll(e), 0) : null } function f(e) { return e.getAttribute ? "#" + e.getAttribute("id") : c(e) } function m(e) { return e instanceof Array ? e.map(function (e) { return "#" + e.getAttribute("id") }).join(", ") : c(e) } function g(e) { return w("`src` property type is deprecated. Use `asset` instead."), a(e) } function v(e) { return y.parse(e, this.default) } var y = e("../utils/coordinates"), M = e("debug"), A = M("core:propertyTypes:warn"), w = M("core:propertyTypes:warn"), x = t.exports.propertyTypes = {}; n("audio", "", a), n("array", [], r, o), n("asset", "", a), n("boolean", !1, u), n("color", "#FFF", s, c), n("int", 0, l), n("number", 0, h), n("map", "", a), n("model", "", a), n("selector", "", d, f), n("selectorAll", "", p, m), n("src", "", g), n("string", "", s, c), n("time", 0, l), n("vec2", { x: 0, y: 0 }, v, y.stringify), n("vec3", { x: 0, y: 0, z: 0 }, v, y.stringify), n("vec4", { x: 0, y: 0, z: 0, w: 0 }, v, y.stringify), t.exports.registerPropertyType = n }, { "../utils/coordinates": 162, debug: 11 }], 103: [function (e, t, i) { function n(e, t) { return t ? { height: e.parentElement.offsetHeight, width: e.parentElement.offsetWidth } : { height: window.innerHeight, width: window.innerWidth } } function r(e) { var t = e.requestFullscreen || e.webkitRequestFullscreen || e.mozRequestFullScreen || e.msRequestFullscreen; t.apply(e) } function o() { document.exitFullscreen ? document.exitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitExitFullscreen && document.webkitExitFullscreen() } var a = e("./metaTags").inject, s = e("./wakelock"), c = e("../a-register-element"), u = e("./scenes"), l = e("../system").systems, h = e("../../lib/three"), d = e("tween.js"), p = e("../../utils/"), f = e("../a-entity"), m = e("../a-node"), g = e("./postMessage"), v = p.bind, y = p.device.isIOS(), M = p.device.isMobile(), A = c.registerElement, w = p.debug("core:a-scene:warn"); t.exports = A("a-scene", { prototype: Object.create(f.prototype, { defaultComponents: { value: { canvas: "", inspector: "", "keyboard-shortcuts": "", screenshot: "", "vr-mode-ui": "", "auto-enter-vr": "" } }, createdCallback: { value: function () { this.isIOS = y, this.isMobile = M, this.isScene = !0, this.object3D = new h.Scene, this.render = v(this.render, this), this.systems = {}, this.time = 0, this.init() } }, init: { value: function () { this.behaviors = [], this.hasLoaded = !1, this.isPlaying = !1, this.originalHTML = this.innerHTML, this.addEventListener("render-target-loaded", function () { this.setupRenderer(), this.resize() }), this.addFullScreenStyles(), g(this) }, writable: !0 }, addFullScreenStyles: { value: function () { var e = document.documentElement; e.classList.add("a-html"), document.body.classList.add("a-body"), this.classList.add("fullscreen") } }, removeFullScreenStyles: { value: function () { var e = document.documentElement; e.classList.remove("a-html"), document.body.classList.remove("a-body"), this.classList.remove("fullscreen") } }, attachedCallback: { value: function () { var e = v(this.resize, this); a(this), s(this), this.initSystems(), window.addEventListener("load", e), window.addEventListener("resize", e), this.play(), u.push(this) }, writable: window.debug }, initSystems: { value: function () { Object.keys(l).forEach(v(this.initSystem, this)) } }, initSystem: { value: function (e) { var t; this.systems[e] || (t = this.systems[e] = new l[e](this), t.init()) } }, detachedCallback: { value: function () { var e; window.cancelAnimationFrame(this.animationFrameID), this.animationFrameID = null, e = u.indexOf(this), u.splice(e, 1) } }, addBehavior: { value: function (e) { var t = this.behaviors; t.indexOf(e) === -1 && t.push(e) } }, checkHeadsetConnected: { value: p.device.checkHeadsetConnected, writable: window.debug }, enterVR: { value: function (e) { function t() { n.addState("vr-mode"), n.emit("enter-vr", e), n.isMobile && screen.orientation && screen.orientation.lock && screen.orientation.lock("landscape"), n.addFullScreenStyles(), n.isMobile || n.checkHeadsetConnected() || r(n.canvas), n.resize() } function i(e) { throw e && e.message ? new Error("Failed to enter VR mode (`requestPresent`): " + e.message) : new Error("Failed to enter VR mode (`requestPresent`).") } var n = this; return this.is("vr-mode") ? Promise.resolve("Already in VR.") : this.checkHeadsetConnected() || this.isMobile ? this.effect.requestPresent().then(t, i) : (t(), Promise.resolve()) } }, exitVR: { value: function () { function e() { i.removeState("vr-mode"), i.isMobile && screen.orientation && screen.orientation.unlock && screen.orientation.unlock(), i.hasAttribute("embedded") && i.removeFullScreenStyles(), i.resize(), i.isIOS && p.forceCanvasResizeSafariMobile(this.canvas), i.emit("exit-vr", { target: i }) } function t(e) { throw e && e.message ? new Error("Failed to exit VR mode (`exitPresent`): " + e.message) : new Error("Failed to exit VR mode (`exitPresent`).") } var i = this; return this.is("vr-mode") ? (o(), this.checkHeadsetConnected() || this.isMobile ? this.effect.exitPresent().then(e, t) : (e(), Promise.resolve())) : Promise.resolve("Not in VR.") } }, getAttribute: { value: function (e) { var t = this.systems[e]; return t ? t.data : f.prototype.getAttribute.call(this, e) } }, getComputedAttribute: { value: function (e) { w("`getComputedAttribute` is deprecated. Use `getAttribute` instead."), this.getAttribute(e) } }, getDOMAttribute: { value: function (e) { var t = this.systems[e]; return t ? t.data : f.prototype.getDOMAttribute.call(this, e) } }, setAttribute: { value: function (e, t, i) { var n = this.systems[e]; return n ? void m.prototype.setAttribute.call(this, e, t) : void f.prototype.setAttribute.call(this, e, t, i) } }, removeBehavior: { value: function (e) { var t = this.behaviors, i = t.indexOf(e); i !== -1 && t.splice(i, 1) } }, resize: { value: function () { var e, t = this.camera, i = this.canvas, r = this.getAttribute("embedded") && !this.is("vr-mode"); !t || !i || this.is("vr-mode") && M || (e = n(i, r), t.aspect = e.width / e.height, t.updateProjectionMatrix(), this.renderer.setSize(e.width, e.height)) }, writable: window.debug }, setupRenderer: { value: function () { var e = this.canvas, t = "true" === this.getAttribute("antialias"), i = this.renderer = new h.WebGLRenderer({ canvas: e, antialias: t || window.hasNativeWebVRImplementation, alpha: !0 }); i.setPixelRatio(window.devicePixelRatio), i.sortObjects = !1, this.effect = new h.VREffect(i) }, writable: window.debug }, play: { value: function () { var e = this; return this.renderStarted ? void f.prototype.play.call(this) : (this.addEventListener("loaded", function () { function e(e) { e.renderStarted || (e.resize(), e.renderer && (window.performance && window.performance.mark("render-started"), e.render(0), e.renderStarted = !0, e.emit("renderstart"))) } return f.prototype.play.call(this), this.camera ? void e(this) : void this.addEventListener("camera-set-active", function () { e(this) }) }), void setTimeout(function () { f.prototype.load.call(e) })) } }, reload: { value: function (e) { function t() { i.isPlaying && f.prototype.play.call(i) } var i = this; e && this.pause(), this.innerHTML = this.originalHTML, this.init(), m.prototype.load.call(this, t) } }, updateComponent: { value: function (e) { e in l || f.prototype.updateComponent.apply(this, arguments) } }, tick: { value: function (e, t) { var i = this.systems; d.update(e), this.behaviors.forEach(function (i) { i.el.isPlaying && i.tick(e, t) }), Object.keys(i).forEach(function (n) { i[n].tick && i[n].tick(e, t) }) } }, render: { value: function (e) { var t = this.effect, i = e - this.time; this.isPlaying && this.tick(e, i), this.animationFrameID = t.requestAnimationFrame(this.render), t.render(this.object3D, this.camera), this.time = e }, writable: !0 } }) }) }, { "../../lib/three": 146, "../../utils/": 167, "../a-entity": 96, "../a-node": 98, "../a-register-element": 99, "../system": 110, "./metaTags": 104, "./postMessage": 105, "./scenes": 106, "./wakelock": 107, "tween.js": 49 }], 104: [function (e, t, i) { function n(e) { return { tagName: "meta", attributes: e, exists: function () { return document.querySelector('meta[name="' + e.name + '"]') } } } function r(e) { return { tagName: "link", attributes: e, exists: function () { return document.querySelector('link[rel="' + e.rel + '"]') } } } function o(e) { if (e && e.tagName) { var t = document.createElement(e.tagName); return t.setAttribute(a.AFRAME_INJECTED, ""), s(t, e.attributes) } } var a = e("../../constants/"), s = e("../../utils").extend, c = t.exports.MOBILE_HEAD_TAGS = [n({ name: "viewport", content: "width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui" }), n({ name: "mobile-web-app-capable", content: "yes" }), n({ name: "theme-color", content: "black" })], u = [n({ name: "apple-mobile-web-app-capable", content: "yes" }), n({ name: "apple-mobile-web-app-status-bar-style", content: "black" }), r({ rel: "apple-touch-icon", href: "https://aframe.io/images/aframe-logo-152.png" })]; t.exports.inject = function (e) { function t(e) { e && !e.exists() && (i = o(e), i && (r ? r.parentNode.insertBefore(i, r) : n.appendChild(i), a.push(i))) } var i, n = document.head, r = n.querySelector("script"), a = []; return c.forEach(t), e.isIOS && u.forEach(t), a } }, { "../../constants/": 91, "../../utils": 167 }], 105: [function (e, t, i) { function n(e) { var t = this; if (e.data) switch (e.data.type) { case "vr": switch (e.data.data) { case "enter": t.enterVR(); break; case "exit": t.exitVR() } } } var r = e("../../utils/bind"), o = e("../../utils/").isIframed; t.exports = function (e) { o() && window.addEventListener("message", r(n, e)) } }, { "../../utils/": 167, "../../utils/bind": 161 }], 106: [function (e, t, i) { t.exports = [] }, {}], 107: [function (e, t, i) { var n = e("../../../vendor/wakelock/wakelock"); t.exports = function (e) { if (e.isMobile) { var t = e.wakelock = new n; e.addEventListener("enter-vr", function () { t.request() }), e.addEventListener("exit-vr", function () { t.release() }) } } }, { "../../../vendor/wakelock/wakelock": 177 }], 108: [function (e, t, i) { function n(e) { return "type" in e ? "string" == typeof e.type : "default" in e } function r(e) { var t, i = e.default, n = e.type; return e.type ? "bool" === e.type ? n = "boolean" : "float" === e.type && (n = "number") : n = void 0 !== i && ["boolean", "number"].indexOf(typeof i) !== -1 ? typeof i : Array.isArray(i) ? "array" : "string", t = c[n], t || u("Unknown property type: " + n), e.parse = e.parse || t.parse, e.stringify = e.stringify || t.stringify, e.type = n, "default" in e || (e.default = t.default), e } function o(e, t) { return void 0 !== e && null !== e && "" !== e || (e = t.default), t.parse(e, t.default) } function a(e, t) { return "object" != typeof e ? e : t && null !== e ? t.stringify(e) : JSON.stringify(e) } var s = e("../utils/debug"), c = e("./propertyTypes").propertyTypes, u = s("core:schema:warn"); t.exports.isSingleProperty = n, t.exports.process = function (e) { return n(e) ? r(e) : (Object.keys(e).forEach(function (t) { e[t] = r(e[t]) }), e) }, t.exports.processPropertyDefinition = r, t.exports.parseProperties = function (e, t, i, n, r) { var a = Object.keys(i ? e : t); return null === e || "object" != typeof e ? e : (Object.keys(e).forEach(function (e) { t[e] || r || u("Unknown property `" + e + "` for component/system `" + n + "`.") }), a.forEach(function (i) { var n = t[i], r = e[i]; t[i] && (e[i] = o(r, n)) }), e) }, t.exports.parseProperty = o, t.exports.stringifyProperties = function (e, t) { var i = {}; return Object.keys(e).forEach(function (n) { var r = t[n], o = e[n], s = o; "object" == typeof s && (s = a(o, r), r || u("Unknown component property: " + n)), i[n] = s }), i }, t.exports.stringifyProperty = a }, { "../utils/debug": 163, "./propertyTypes": 102 }], 109: [function (e, t, i) { var n = e("./schema"), r = n.process, o = t.exports.shaders = {}, a = t.exports.shaderNames = [], s = e("../lib/three"), c = e("../utils"), u = { array: "v3", color: "v3", int: "i", number: "f", map: "t", time: "f", vec2: "v2", vec3: "v3", vec4: "v4" }, l = t.exports.Shader = function () { }; l.prototype = { schema: {}, vertexShader: "void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}", fragmentShader: "void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}", init: function (e) { return this.attributes = this.initVariables(e, "attribute"), this.uniforms = this.initVariables(e, "uniform"), this.material = new (this.raw ? s.RawShaderMaterial : s.ShaderMaterial)({ uniforms: this.uniforms, vertexShader: this.vertexShader, fragmentShader: this.fragmentShader }), this.material }, initVariables: function (e, t) { var i = {}, n = this.schema; return Object.keys(n).forEach(function (e) { if (n[e].is === t) { var r = u[n[e].type]; i[e] = { type: r, value: void 0 } } }), i }, update: function (e) { this.updateVariables(e, "attribute"), this.updateVariables(e, "uniform") }, updateVariables: function (e, t) { var i = this, n = "uniform" === t ? this.uniforms : this.attributes, r = this.schema; Object.keys(e).forEach(function (o) { var a; if (r[o] && r[o].is === t) { if ("map" === r[o].type) { if (!n[o] || n[o].value === e[o]) return; return a = "_texture_" + o, i.el.addEventListener("materialtextureloaded", function () { n[o].value = i.material[a], n[o].needsUpdate = !0 }), void c.material.updateMapMaterialFromData(a, o, i, e) } n[o].value = i.parseValue(r[o].type, e[o]), n[o].needsUpdate = !0 } }) }, parseValue: function (e, t) { var i; switch (e) { case "vec2": return new s.Vector2(t.x, t.y); case "vec3": return new s.Vector3(t.x, t.y, t.z); case "vec4": return new s.Vector4(t.x, t.y, t.z, t.w); case "color": return i = new s.Color(t), new s.Vector3(i.r, i.g, i.b); default: return t } } }, t.exports.registerShader = function (e, t) { var i, n = {}; if (Object.keys(t).forEach(function (e) { n[e] = { value: t[e], writable: !0 } }), o[e]) throw new Error("The shader " + e + " has been already registered"); return i = function () { l.call(this) }, i.prototype = Object.create(l.prototype, n), i.prototype.name = e, i.prototype.constructor = i, o[e] = { Shader: i, schema: r(i.prototype.schema) }, a.push(e), i } }, { "../lib/three": 146, "../utils": 167, "./schema": 108 }], 110: [function (e, t, i) { var n = e("./component"), r = e("./schema"), o = e("../utils/"), a = r.parseProperties, s = r.parseProperty, c = r.process, u = r.isSingleProperty, l = o.styleParser, h = t.exports.systems = {}, d = t.exports.System = function (e) { var t, i = n && n.components[this.name], r = this.schema; if (this.sceneEl = e, i && (i.Component.prototype.system = this), Object.keys(r).length) return t = HTMLElement.prototype.getAttribute.call(e, this.name), u(r) ? void (this.data = s(t, r)) : void (this.data = a(l.parse(t) || {}, r, !1, this.name)) }; d.prototype = { schema: {}, init: function () { }, tick: void 0, play: function () { }, pause: function () { } }, t.exports.registerSystem = function (e, t) { var i, n, r = {}, a = o.findAllScenes(document); if (Object.keys(t).forEach(function (e) { r[e] = { value: t[e], writable: !0 } }), h[e]) throw new Error("The system `" + e + "` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name."); for (n = function (e) { d.call(this, e) }, n.prototype = Object.create(d.prototype, r), n.prototype.name = e, n.prototype.constructor = n, n.prototype.schema = o.extend(c(n.prototype.schema)), h[e] = n, i = 0; i < a.length; i++)a[i].initSystem(e) } }, { "../utils/": 167, "./component": 100, "./schema": 108 }], 111: [function (e, t, i) { e("./pivot") }, { "./pivot": 112 }], 112: [function (e, t, i) { var n = e("../../core/component").registerComponent, r = e("../../lib/three"), o = new r.Vector3, a = new r.Vector3; n("pivot", { dependencies: ["position"], schema: { type: "vec3" }, init: function () { var e = this.data, t = this.el, i = t.object3D.parent, n = t.object3D, s = new r.Group; o.copy(n.position), a.copy(n.rotation), i.remove(n), s.add(n), i.add(s), t.object3D = s, n.position.set(-1 * e.x, -1 * e.y, -1 * e.z), s.position.set(e.x + o.x, e.y + o.y, e.z + o.z), s.rotation.copy(n.rotation), n.rotation.set(0, 0, 0) } }) }, { "../../core/component": 100, "../../lib/three": 146 }], 113: [function (e, t, i) { function n(e) { var t = e.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase(); "fog" === e && (t = "material-fog"), "visible" === e && (t = "material-visible"), s[t] = "material." + e } var r = e("../../core/component").components, o = e("../../core/shader").shaders, a = e("../../utils/"), s = {}; Object.keys(r.material.schema).forEach(n), Object.keys(o.standard.schema).forEach(n), t.exports = function () { return { defaultComponents: { material: {} }, mappings: a.extend({}, s) } } }, { "../../core/component": 100, "../../core/shader": 109, "../../utils/": 167 }], 114: [function (e, t, i) { e("./primitives/a-camera"), e("./primitives/a-collada-model"), e("./primitives/a-cursor"), e("./primitives/a-curvedimage"), e("./primitives/a-gltf-model"), e("./primitives/a-image"), e("./primitives/a-light"), e("./primitives/a-obj-model"), e("./primitives/a-sky"), e("./primitives/a-sound"), e("./primitives/a-text"), e("./primitives/a-video"), e("./primitives/a-videosphere"), e("./primitives/meshPrimitives") }, { "./primitives/a-camera": 116, "./primitives/a-collada-model": 117, "./primitives/a-cursor": 118, "./primitives/a-curvedimage": 119, "./primitives/a-gltf-model": 120, "./primitives/a-image": 121, "./primitives/a-light": 122, "./primitives/a-obj-model": 123, "./primitives/a-sky": 124, "./primitives/a-sound": 125, "./primitives/a-text": 126, "./primitives/a-video": 127, "./primitives/a-videosphere": 128, "./primitives/meshPrimitives": 129 }], 115: [function (e, t, i) { function n(e, t) { var i = a[e].schema; Object.keys(i).map(function (i) { var n = i.replace(/([a-z])([A-Z])/g, "$1-$2").toLowerCase(); void 0 !== t[n] && (n = e + "-" + i), t[n] = e + "." + i }) } function r(e, i, r) { r = r || {}, Object.keys(i).map(function (e) { n(e, r) }), t.exports.registerPrimitive(e, c.extendDeep({}, null, { defaultComponents: i, mappings: r })) } var o = e("../../core/a-entity"), a = e("../../core/component").components, s = e("../../core/a-register-element").registerElement, c = e("../../utils/"), u = c.debug, l = c.entity.setComponentProperty, h = u("extras:primitives:debug"), d = u("extras:primitives:warn"), p = t.exports.primitives = {}; t.exports.registerPrimitive = function (e, t) { e = e.toLowerCase(), h("Registering <%s>", e), t.defaultAttributes && d("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead."); var i = s(e, { prototype: Object.create(o.prototype, { defaultComponentsFromPrimitive: { value: t.defaultComponents || t.defaultAttributes || {} }, deprecated: { value: t.deprecated || null }, deprecatedMappings: { value: t.deprecatedMappings || {} }, mappings: { value: t.mappings || {} }, createdCallback: { value: function () { t.deprecated && console.warn(t.deprecated), this.resolveMappingCollisions() } }, resolveMappingCollisions: { value: function () { var e = this.mappings, t = this; Object.keys(e).forEach(function (i) { var n; a[i] && (n = e[i].replace(".", "-"), e[n] = e[i], delete e[i], console.warn("The primitive " + t.tagName.toLowerCase() + " has a mapping collision. The attribute " + i + " has the same name as a registered component and has been renamed to " + n)) }) } }, getExtraComponents: { value: function () { var e, t, i, n, r, o, a = this; for (t = c.clone(this.defaultComponentsFromPrimitive), r = this.getAttribute("mixin"), r && (r = r.trim().split(" "), r.forEach(function (e) { var i = a.sceneEl.querySelector("#" + e).componentCache; Object.keys(i).forEach(function (e) { t[e] = c.extendDeep(t[e] || {}, i[e]) }) })), i = 0; i < this.attributes.length; i++)e = this.attributes[i], n = this.mappings[e.name], n && (o = c.entity.getComponentPropertyPath(n), o.constructor === Array ? t[o[0]][o[1]] = e.value : t[o] = e.value); return t } }, attributeChangedCallback: { value: function (e, t, i) { var n = this.mappings[e]; e in this.deprecatedMappings && console.warn(this.deprecatedMappings[e]), e && n && l(this, n, i) } } }) }); return p[e] = i, i }, t.exports.definePrimitive = r }, { "../../core/a-entity": 96, "../../core/a-register-element": 99, "../../core/component": 100, "../../utils/": 167 }], 116: [function (e, t, i) { var n = e("../../../constants/").DEFAULT_CAMERA_HEIGHT, r = e("../primitives").registerPrimitive; r("a-camera", { defaultComponents: { camera: { userHeight: n }, "look-controls": {}, "wasd-controls": {} }, mappings: { active: "camera.active", far: "camera.far", fov: "camera.fov", "look-controls-enabled": "look-controls.enabled", near: "camera.near", "wasd-controls-enabled": "wasd-controls.enabled", "reverse-mouse-drag": "look-controls.reverseMouseDrag", "user-height": "camera.userHeight",